<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CSS Minifier</title>
    <style>
:root{--bg-color:#fff;--text-color:#333;--border-color:#ddd;--primary-color:#4a90e2;--container-bg:#f5f5f5}body.dark-mode{--bg-color:#1a1a1a;--text-color:#fff;--border-color:#444;--container-bg:#2d2d2d}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background-color:var(--bg-color);color:var(--text-color);transition:.3s}.container{max-width:1200px;margin:2rem auto;padding:1rem}.minifier-container{background-color:var(--container-bg);border-radius:8px;padding:1.5rem;box-shadow:0 2px 10px rgba(0,0,0,.1)}.textarea-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem;margin-bottom:1rem}textarea{width:100%;height:400px;padding:1rem;border:1px solid var(--border-color);border-radius:4px;background-color:var(--bg-color);color:var(--text-color);font-family:'Courier New',monospace;overflow-y:auto}.controls{display:flex;flex-wrap:wrap;gap:1rem;align-items:center;margin-bottom:1rem}.checkbox-container{display:flex;align-items:center;gap:.5rem}button{padding:.5rem 1rem;background-color:var(--primary-color);color:#fff;border:none;border-radius:4px;cursor:pointer;transition:.3s;display:flex;align-items:center;gap:.5rem}button:hover{opacity:.9}.darkmode-toggle{position:fixed;top:1rem;right:1rem}.darkmode-toggle-container{width:60px;height:30px;position:relative;display:block;background:#ebebeb;border-radius:30px;box-shadow:inset 0 2px 6px rgba(0,0,0,.4),inset 0 -2px 6px rgba(255,255,255,.4)}.darkmode-toggle-container:after{content:"";width:24px;height:24px;position:absolute;top:3px;left:3px;background:linear-gradient(180deg,#ffcc89,#d8860b);border-radius:50%;transition:.3s}.darkmode-toggle-container svg{position:absolute;width:12px;height:12px;top:9px;z-index:1}.darkmode-toggle-container svg.sun{left:6px;fill:#fff}.darkmode-toggle-container svg.moon{right:6px;fill:#7e7e7e}.darkmode-toggle input{width:0;height:0;visibility:hidden}.darkmode-toggle input:checked+.darkmode-toggle-container{background:#242424}.darkmode-toggle input:checked+.darkmode-toggle-container:after{left:calc(100% - 27px);background:linear-gradient(180deg,#777,#3a3a3a)}.darkmode-toggle input:checked+.darkmode-toggle-container svg.sun{fill:#7e7e7e}.darkmode-toggle input:checked+.darkmode-toggle-container svg.moon{fill:#fff}footer{text-align:center;padding:2rem;margin-top:2rem;border-top:1px solid var(--border-color)}.github-link{display:inline-flex;align-items:center;gap:.5rem;color:var(--text-color);text-decoration:none;margin-left:1rem}.output-controls{display:flex;justify-content:flex-end;margin-top:1rem}@media (max-width:768px){.container{margin:1rem;padding:.5rem}}
    </style>
</head>
<body>
    <div class="container">
        <div class="darkmode-toggle">
            <input type="checkbox" id="darkmode-toggle"/>
            <label for="darkmode-toggle" class="darkmode-toggle-container">
                <svg xmlns="http://www.w3.org/2000/svg" class="sun" viewBox="0 0 16 16">
                    <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="moon" viewBox="0 0 16 16">
                    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
                </svg>
            </label>
        </div>

        <div class="minifier-container">
            <div class="textarea-container">
                <div>
                    <h3>Input CSS</h3>
                    <textarea id="css-input" placeholder="/* Example CSS */
.example-class {
    color: #333;
    padding: 20px;
    margin: 10px;
}

/* Another section */
.another-class {
    background: #fff;
    border: 1px solid #ddd;
}"></textarea>
                </div>
                <div>
                    <h3>Minified Output</h3>
                    <textarea id="css-output" readonly></textarea>
                    <div class="output-controls">
                        <div class="checkbox-container">
                            <input type="checkbox" id="remove-comments">
                            <label for="remove-comments">Remove comments</label>
                        </div>
                        <button id="copy-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                <path d="M9.5 1H4a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h5.5a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"/>
                            </svg>
                            Copy Minified CSS
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            Made with ❤️ by Sayfullah
            <a href="https://github.com/ssayeb7" class="github-link" target="_blank">
                <svg height="24" viewBox="0 0 16 16" width="24">
                    <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                GitHub
            </a>
        </footer>
    </div>
<script>
// JavaScript code for CSS Minifier
document.addEventListener('DOMContentLoaded', () => {
    // Load dark mode preference only
    const darkModePreference = localStorage.getItem('darkMode') === 'true';
    const darkModeToggle = document.getElementById('darkmode-toggle');
    darkModeToggle.checked = darkModePreference;
    document.body.classList.toggle('dark-mode', darkModePreference);

    // Dark mode toggle listener
    darkModeToggle.addEventListener('change', (e) => {
        document.body.classList.toggle('dark-mode', e.target.checked);
        localStorage.setItem('darkMode', e.target.checked);
    });

    // Remove comments checkbox listener
    document.getElementById('remove-comments').addEventListener('change', function() {
        minifyCSS();
    });

    // Input textarea listener with debounce
    let debounceTimer;
    document.getElementById('css-input').addEventListener('input', function() {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
            minifyCSS();
        }, 300);
    });

    // Copy button listener
    document.getElementById('copy-button').addEventListener('click', async function() {
        const copyBtn = document.getElementById('copy-button');
        const outputText = document.getElementById('css-output').value;

        try {
            await navigator.clipboard.writeText(outputText);
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copied!';
            
            // Visual feedback animation
            copyBtn.style.backgroundColor = '#28a745';
            setTimeout(() => {
                copyBtn.textContent = 'Copy Minified CSS';
                copyBtn.style.backgroundColor = '';
            }, 2000);
        } catch (err) {
            console.error('Failed to copy text:', err);
            copyBtn.textContent = 'Failed to copy';
            setTimeout(() => {
                copyBtn.textContent = 'Copy Minified CSS';
            }, 2000);
        }
    });

    // Initial minification
    minifyCSS();
});

// CSS Minification Function
function minifyCSS() {
    const input = document.getElementById('css-input').value;
    const removeComments = document.getElementById('remove-comments').checked;
    let output = input;

    try {
        // Remove comments if checkbox is checked
        if (removeComments) {
            output = output.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g, '');
        }

        // Process the CSS
        output = output
            // Remove whitespace around special characters
            .replace(/\s*([{}:;,])\s*/g, '$1')
            // Remove unnecessary semicolons
            .replace(/;}/g, '}')
            // Remove multiple spaces
            .replace(/\s+/g, ' ')
            // Remove spaces between brackets
            .replace(/\s*{\s*/g, '{')
            // Clean up whitespace
            .trim()
            // Ensure proper formatting for selectors
            .replace(/}\s*/g, '}\n')
            // Handle media queries
            .replace(/@media[^{]+\{/g, match => match.trim() + '\n')
            // Ensure clean line breaks between rules
            .replace(/}\n\s+/g, '}\n')
            // Remove empty lines
            .replace(/^\s*[\r\n]/gm, '')
            // Ensure each selector starts on a new line
            .replace(/([^}])\s*{/g, '$1{');

        // Final cleanup for consistent formatting
        output = output
            .split('\n')
            .map(line => line.trim())
            .filter(line => line.length > 0)
            .join('\n');

        document.getElementById('css-output').value = output;
    } catch (error) {
        console.error('Minification error:', error);
        document.getElementById('css-output').value = 'Error occurred during minification';
        document.getElementById('css-output').style.borderColor = 'red';
    }
}

// Helper function to validate CSS
function isValidCSS(css) {
    try {
        const style = document.createElement('style');
        style.textContent = css;
        document.head.appendChild(style);
        document.head.removeChild(style);
        return true;
    } catch (e) {
        return false;
    }
}
</script>
</body>
</html>
